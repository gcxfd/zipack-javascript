<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body style="width: 50%; font-size: 20px;     line-height: 33px;">


    JSON: <span id="json-info"></span>
    <br>
    <textarea id="input" name="" id="" cols="50" rows="10"></textarea>
    <br>
    zipack: <span id="zipack-info"></span>
    <br>
    <textarea id="output" disabled name="" id="" cols="50" rows="10"></textarea>
    <script type="module">
        import zipack from './zipack.js'

        const input = document.querySelector('#input')
        const output = document.querySelector('#output')
        const jsonInfo = document.querySelector('#json-info')
        const zipackInfo = document.querySelector('#zipack-info')
        input.oninput = function () {
            try {
                const q = zipack.serialize(JSON.parse(input.value))
                output.value = [...q].map(x => x.toString(16).toUpperCase().padStart(2, 0)).join(' ')
                const jsonLength = new TextEncoder().encode(input.value).length
                jsonInfo.textContent = `${jsonLength} bytes`
                zipackInfo.textContent = `${q.length} bytes   (${Math.round(q.length * 100 / jsonLength)}%)`
            } catch (err) {
                output.value = 'JSON Parse Error'
                jsonInfo.textContent = ``
                zipackInfo.textContent = ``
            }
        }

        input.value = JSON.stringify({ "compact": true, "schema": 0 })
        input.oninput()
    </script>



</body>

</html>